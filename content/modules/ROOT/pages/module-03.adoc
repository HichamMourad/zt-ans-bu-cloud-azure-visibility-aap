= Lab Guide: Creating Dynamic Documentation for Azure
:notoc:
:toc-title: Table of Contents
:sectnums:
:icons: font

---

== Lab Guide: Hands-On Tasks

*Estimated time to complete: 20 minutes*

Welcome to the third challenge. You will now generate an HTML website using the structured data gathered from your Azure environment.

First, log in to the automation controller with the following credentials.

.Login Credentials
[cols="1,2a"]
|===
| Username | `admin`
| Password | `ansible123!`
|===

=== Task 1: Create the "Create Report" Job Template

You will start by creating a job template that runs a playbook to generate the cloud report.

. **Navigate to the Templates page.**
+
Expand the `Automation Execution` menu on the left.
`Automation Execution` -> `Templates`.

. **Create a new job template.**
+
Click the `+ Create Template` then scroll down and click `Create job template`

. **Enter the job template details.**
+
Fill out the form with the following information:
+
[cols="1,1"]
|===
| Parameter | Value
| Name | `Create Azure Cloud Report`
| Job Type | `Run`
| Inventory | `Azure Inventory`
| Project | `Cloud Visibility Project`
| Playbook | `playbooks/cloud_report_azure.yml`
| Execution Environment | `Microsoft Azure Execution Environment`
| Credentials | `azure_credential` AND `SSH Controller Credential`
|===
+
TIP: To select the `azure_credential`, click in the text field or on the drop down icon, then select `Microsoft Azure Resource Manager`.

. **Save the job template.**
+
**Click** the blue `Create job template` button.

NOTE: The Ansible Playbooks for this lab are sourced from this link:https://github.com/ansible-cloud/azure_visibility[project on GitHub].

=== Task 2: Launch the Job Template

Now you are ready to run the job and generate the report.

. **Launch the job template.**
+
Navigate back to the **Templates** page. Find the `Create Azure Cloud Report` template and click `ðŸš€ Launch template` icon.
+
image:https://github.com/IPvSean/pictures_for_github/blob/master/launch_job.png?raw=true[Launch Job Icon, 30, opts="border"]

. **Understand the playbook execution.**
+
This playbook uses two roles:
+
. The first role retrieves structured data for regions, virtual networks, and virtual machines.
. The second role creates an HTML report. It installs a web server, copies assets (CSS, images), and uses the structured data to generate a dynamic website.

. **View the generated report.**
+
Once the job completes, **navigate** to the `Dynamic Report` tab at the top of your lab window. You may need to refresh the page (âŸ³). `Click` on the gray boxes with the caret (`â–¸`) to expand the table rows with additional information.
+
You will see a report similar to this:
+
image::../assets/azure_report.png[Generated Azure cloud report, opts="border"]

=== Task 3: Analyze the Report

A cloud operator can use this report to quickly gain awareness of their cloud footprint. It combines information from several info modules, which correspond to multiple Azure API calls.

Important considerations for a cloud operator include:

* How can we identify virtual networks in Azure that are not in use and can be safely deleted?
* Which regions are running instances versus which ones are empty?
* Which regions have stopped instances that may turn on at any moment?

---

== Conclusion

You have successfully completed this lab! We hope you enjoyed learning about how Ansible can be used to create dynamic documentation for your Azure environment.

== Troubleshooting

If you have encountered an issue or have noticed something not quite right, please link:https://github.com/ansible/instruqt/issues/new?title=Issue+with+Ansible+Hybrid+Cloud+Automation+-+Infrastructure+visibility&assignees=ipvsean[open an issue on GitHub].
