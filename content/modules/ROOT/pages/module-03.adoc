= Lab Guide: Creating Dynamic Documentation for Azure
:notoc:
:toc-title: Table of Contents
:sectnums:
:icons: font

---

== Lab Guide: Hands-On Tasks

*Estimated time to complete: 5 minutes*

Welcome to the third challenge. You will now generate an HTML website using the structured data gathered from your Azure environment.

First, log in to the automation controller with the following credentials.

.Login Credentials
[cols="1,2a"]
|===
| Username | `admin`
| Password | `ansible123!`
|===

=== Task 1: Create the "Create Report" Job Template

You will start by creating a job template that runs a playbook to generate the cloud report.

. **Navigate to the Templates page.**
+
In the left navigation menu, go to **Resources** â†’ **Templates**.
+
image::https://github.com/IPvSean/pictures_for_github/blob/master/job_templates.png?raw=true[Templates link in the navigation menu, opts="border"]

. **Create a new job template.**
+
**Click** the blue **Add** button and select **Add job template**.

. **Enter the job template details.**
+
Fill out the form with the following information:
+
[cols="1,1"]
|===
| Parameter | Value
| Name | `Create Report`
| Job Type | `Run`
| Inventory | `Azure Inventory`
| Project | `Cloud Visibility Project`
| Execution Environment | `Microsoft Azure Execution Environment`
| Playbook | `playbooks/cloud_report_azure.yml`
| Credentials | `azure_credential`
|===
+
TIP: To find the `azure_credential`, you may need to filter the *Credential Type* to `Microsoft Azure Resource Manager`.

. **Save the job template.**
+
**Click** the blue **Save** button.

NOTE: The Ansible Playbooks for this lab are sourced from this link:https://github.com/ansible-cloud/azure_visibility[project on GitHub].

=== Task 2: Launch the Job Template

Now you are ready to run the job and generate the report.

. **Launch the job template.**
+
From the **Templates** page, find the `Create Report` template and **click** the **Launch** icon (ðŸš€).
+
image:https://github.com/IPvSean/pictures_for_github/blob/master/launch_job.png?raw=true[Launch Job Icon, 30, opts="border"]

. **Understand the playbook execution.**
+
This playbook uses two roles:
+
. The first role retrieves structured data for regions, virtual networks, and virtual machines.
. The second role creates an HTML report. It installs a web server, copies assets (CSS, images), and uses the structured data to generate a dynamic website.

. **View the generated report.**
+
Once the job completes, **navigate** to the **Dynamic Report** tab at the top of your lab window. You may need to refresh the page (âŸ³). **Click** on the gray boxes with the caret (`â–¸`) to expand the tables with additional information.
+
You will see a report similar to this:
+
image::../assets/azure_report.png[Generated Azure cloud report, opts="border"]

=== Task 3: Analyze the Report

A cloud operator can use this report to quickly gain awareness of their cloud footprint. It combines information from several info modules, which correspond to multiple Azure API calls.

Important considerations for a cloud operator include:

* How can we identify virtual networks in Azure that are not in use and can be safely deleted?
* Which regions are running instances versus which ones are empty?
* Which regions have stopped instances that may turn on at any moment?

---

== Conclusion

You have successfully completed this lab! Press the `Check` button below to validate your work.

== Troubleshooting

If you have encountered an issue or have noticed something not quite right, please link:https://github.com/ansible/instruqt/issues/new?title=Issue+with+Ansible+Hybrid+Cloud+Automation+-+Infrastructure+visibility&assignees=ipvsean[open an issue on GitHub].
